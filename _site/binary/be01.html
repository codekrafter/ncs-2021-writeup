<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>NCS 2021 Writeup | My writeup for the National Cyber Scholarship Competition 2021</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="NCS 2021 Writeup" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="My writeup for the National Cyber Scholarship Competition 2021" />
<meta property="og:description" content="My writeup for the National Cyber Scholarship Competition 2021" />
<link rel="canonical" href="http://localhost:4000/binary/be01.html" />
<meta property="og:url" content="http://localhost:4000/binary/be01.html" />
<meta property="og:site_name" content="NCS 2021 Writeup" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NCS 2021 Writeup" />
<script type="application/ld+json">
{"headline":"NCS 2021 Writeup","description":"My writeup for the National Cyber Scholarship Competition 2021","url":"http://localhost:4000/binary/be01.html","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=76ae22a8c1af124b3734163c62ff980a0c1a0119">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/codekrafter/ncs-2021-writeup">View On GitHub</a></li>
          
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>NCS 2021 Writeup</h1>
          <p>My writeup for the National Cyber Scholarship Competition 2021</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/codekrafter">codekrafter</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <p><a href="/">go back home</a></p>

<h1 id="be01">BE01</h1>

<h2 id="briefing">Briefing</h2>

<p>Download the file and find a way to get the flag.</p>

<p>Contents: <strong>chicken.pdf</strong></p>

<h2 id="walkthrough">Walkthrough</h2>

<p>This challenge starts off with a simple PDF, that just contains an image of a chicken. I tried to select any hidden text by pressing ctrl+a and had no luck. PDF files can contain lots of different objects, so I ran it through <code class="language-plaintext highlighter-rouge">pdf-parser --stats</code> to list all of the different types of objects:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pdf-parser chicken.pdf <span class="nt">--stats</span>
This program has not been tested with this version of Python <span class="o">(</span>3.9.2<span class="o">)</span>
Should you encounter problems, please use Python version 3.8.7
Comment: 3
XREF: 1
Trailer: 1
StartXref: 1
Indirect object: 10
  6: 1, 3, 6, 7, 9, 10
 /Catalog 1: 5
 /Page 1: 4
 /Pages 1: 2
 /XObject 1: 8

</code></pre></div></div>

<p>As we can see there are a few different objects, but the one that caught my eye was the XObject. Using <code class="language-plaintext highlighter-rouge">pdf-parser -o 8</code> (as the XObject has an ID of 8), I found out that it was an image, the chicken on the page. I then used <code class="language-plaintext highlighter-rouge">binwalk -e chicken.pdf</code> to try to extract the image out so I could look at it. To my surprise binwalk detected a few things including a zip achive and some zlib data (which is the image data as PNGs use zlib to store the image), but not the actual image:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PDF document, version: "1.4"
72            0x48            Zip archive data, at least v1.0 to extract, compressed size: 550522, uncompressed size: 550522, name: egg.zip
550609        0x866D1         End of Zip archive, footer length: 22
551319        0x86997         Zlib compressed data, default compression
6478358       0x62DA16        Zlib compressed data, default compression
6478601       0x62DB09        End of Zip archive, footer length: 22
</code></pre></div></div>

<p>Because of how the PDF stores the image it doesnâ€™t include the magic bytes of the image which is what binwalk uses, but it did detect the image data. But since I got a zip file, I no longer cared about the image. Extracting egg.zip results in chicken.zip, which when extracted results in another egg.zip. I extracted that out and calculated an md5 hash of both egg.zip files to confirm they were different. As they had different hashes, I continued extracting in a cycle of egg.zip and chicken.zip files and eventually came to egg.pdf, which when opened contains the following image that contains the flag:</p>

<p><img src="/assets/images/be01_egg_pdf.jpg" alt="egg.pdf" /></p>


      </section>

    </div>

    
  </body>
</html>
